<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tablerreur ‚Äî Contr√¥le qualit√© tableurs</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <header class="app-header">
    <h1 class="app-title">Tablerreur</h1>
    <p class="app-subtitle">Contr√¥le qualit√© pour tableurs CSV/XLSX</p>
    <button id="theme-toggle" class="btn-icon btn-theme-toggle" onclick="toggleTheme()" title="Basculer le th√®me sombre / clair">üåô</button>
  </header>

  <!-- Step navigation -->
  <nav class="step-nav" id="step-nav">
    <button class="step-btn active" data-step="upload" onclick="goToStep('upload')">
      <span class="step-num">1</span> T√©l√©verser
    </button>
    <span class="step-sep">‚Ä∫</span>
    <button class="step-btn" data-step="configure" onclick="goToStep('configure')" disabled>
      <span class="step-num">2</span> Configurer
    </button>
    <span class="step-sep">‚Ä∫</span>
    <button class="step-btn" data-step="fixes" onclick="goToStep('fixes')" disabled>
      <span class="step-num">3</span> Correctifs
    </button>
    <span class="step-sep">‚Ä∫</span>
    <button class="step-btn" data-step="validate" onclick="goToStep('validate')" disabled>
      <span class="step-num">4</span> Valider
    </button>
    <span class="step-sep">‚Ä∫</span>
    <button class="step-btn" data-step="results" onclick="goToStep('results')" disabled>
      <span class="step-num">5</span> R√©sultats
    </button>
  </nav>

  <main class="main-content">

    <!-- ================================================================
         √âTAPE 1 : T√âL√âVERSEMENT
         ================================================================ -->
    <section id="step-upload" class="step-section active">
      <h2>T√©l√©verser un fichier</h2>

      <div class="upload-zone" id="upload-zone">
        <div class="upload-inner">
          <div class="upload-icon">üìÅ</div>
          <p>D√©posez votre fichier ici ou</p>
          <label class="btn btn-secondary" for="file-input">Parcourir‚Ä¶</label>
          <input type="file" id="file-input" accept=".csv,.xlsx,.xls,.xlsm,.tsv,.txt" hidden />
          <p class="upload-hint">Formats accept√©s : CSV, XLSX, XLS, TSV</p>
        </div>
        <div class="upload-file-info" id="upload-file-info" hidden>
          <span id="upload-filename"></span>
          <button class="btn-icon" onclick="clearFile()" title="Changer de fichier">‚úï</button>
        </div>
      </div>

      <div class="card mt-2">
        <h3>Options d'import</h3>
        <div class="form-grid">
          <label for="header-row">Ligne d'en-t√™te :</label>
          <input type="number" id="header-row" value="1" min="1" max="100" class="input-sm" />

          <label for="delimiter">D√©limiteur (CSV) :</label>
          <select id="delimiter" class="input-sm">
            <option value="">(d√©tection auto)</option>
            <option value=";">;</option>
            <option value=",">,</option>
            <option value="\t">tabulation</option>
            <option value="|">|</option>
          </select>

          <label for="encoding">Encodage :</label>
          <select id="encoding" class="input-sm">
            <option value="">(d√©tection auto)</option>
            <option value="utf-8">UTF-8</option>
            <option value="utf-8-sig">UTF-8 BOM</option>
            <option value="latin-1">Latin-1</option>
            <option value="cp1252">CP1252</option>
          </select>
        </div>
      </div>

      <div class="card mt-2">
        <h3>Mod√®le de validation</h3>
        <div class="form-grid">
          <label for="template-id">Choisir un mod√®le :</label>
          <select id="template-id" class="input-sm">
            <option value="generic_default">G√©n√©rique ‚Äî D√©faut</option>
            <option value="generic_strict">G√©n√©rique ‚Äî Strict</option>
            <option value="nakala_baseline">NAKALA ‚Äî R√©f√©rence</option>
            <option value="nakala_extended">NAKALA ‚Äî √âtendu</option>
          </select>
        </div>
        <div class="upload-template-row mt-1">
          <span class="format-hint">ou </span>
          <button class="btn-link" onclick="triggerUploadTemplateInput()">importer un mod√®le personnalis√© (.yml)</button>
          <input type="file" id="upload-template-input" accept=".yml,.yaml" hidden />
          <span id="upload-template-name" class="upload-template-name" hidden></span>
        </div>
      </div>

      <div class="action-row mt-2">
        <div id="upload-error" class="msg-error" hidden></div>
        <div id="upload-progress" class="msg-info" hidden>T√©l√©versement en cours‚Ä¶</div>
        <button class="btn btn-primary" onclick="doUpload()">√âtape suivante ‚Üí</button>
      </div>
    </section>

    <!-- ================================================================
         √âTAPE 2 : CONFIGURATION DES COLONNES
         ================================================================ -->
    <section id="step-configure" class="step-section" hidden>
      <h2>Configuration des colonnes</h2>
      <p class="step-desc">
        Cliquez sur un en-t√™te de colonne pour configurer ses r√®gles de validation.
        Cette √©tape est facultative ‚Äî vous pouvez passer directement aux correctifs.
      </p>

      <!-- Barre d'actions mod√®le -->
      <div class="template-actions">
        <button class="btn btn-secondary" id="btn-import-template" onclick="triggerImportTemplate()">
          üìÇ Importer un mod√®le
        </button>
        <button class="btn btn-secondary" id="btn-export-template" onclick="exportTemplate()">
          üíæ Exporter la configuration
        </button>
      </div>
      <input type="file" id="import-template-input" accept=".yml,.yaml" hidden />

      <!-- Toast notifications -->
      <div id="template-toast" class="template-toast" hidden role="status" aria-live="polite"></div>

      <div class="card preview-table-wrapper">
        <div id="preview-table-container" style="overflow-x: auto;">
          <div id="preview-loading" class="msg-info" style="padding: 1rem 0;">Chargement de l'aper√ßu‚Ä¶</div>
          <table id="preview-table" class="preview-table" hidden>
            <thead><tr id="preview-header"></tr></thead>
            <tbody id="preview-body"></tbody>
          </table>
        </div>
      </div>

      <!-- Column config panel ‚Äî static HTML, populated dynamically -->
      <div id="column-config-panel" class="card mt-2" hidden>
        <div class="col-config-header">
          <h3 class="col-config-title">Configuration ‚Äî <span id="col-config-name"></span></h3>
          <button class="btn-icon" onclick="closeColumnConfig()" title="Fermer">‚úï</button>
        </div>
        <div class="col-config-grid">
          <div class="col-config-field col-config-full">
            <label class="checkbox-label">
              <input type="checkbox" id="cfg-required" />
              Valeur obligatoire (les cellules vides seront signal√©es)
            </label>
          </div>
          <div class="col-config-field">
            <label for="cfg-content-type">Type de contenu</label>
            <select id="cfg-content-type" class="input-sm">
              <option value="">Aucun</option>
              <option value="integer">Nombre entier</option>
              <option value="decimal">Nombre d√©cimal</option>
              <option value="date">Date</option>
              <option value="email">Adresse e-mail</option>
              <option value="url">URL</option>
            </select>
          </div>
          <div class="col-config-field col-config-checks">
            <label class="checkbox-label">
              <input type="checkbox" id="cfg-unique" />
              Valeurs uniques obligatoires
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="cfg-multiline" />
              Retours √† la ligne autoris√©s
            </label>
          </div>
          <div class="col-config-field">
            <label for="cfg-format-preset">Format attendu</label>
            <select id="cfg-format-preset" class="input-sm format-preset-select">
              <option value="">Aucun</option>
              <optgroup label="‚îÄ‚îÄ Formats g√©n√©raux">
                <option value="year">Ann√©e (YYYY)</option>
                <option value="yes_no">Oui / Non</option>
                <option value="alphanum">Alphanum√©rique</option>
                <option value="letters_only">Lettres uniquement</option>
                <option value="positive_int">Nombre entier positif</option>
              </optgroup>
              <optgroup label="‚îÄ‚îÄ Identifiants &amp; liens">
                <option value="doi">DOI</option>
                <option value="orcid">ORCID</option>
                <option value="ark">ARK</option>
                <option value="issn">ISSN</option>
              </optgroup>
              <optgroup label="‚îÄ‚îÄ Dates">
                <option value="w3cdtf">Date W3C-DTF (YYYY, YYYY-MM ou YYYY-MM-DD)</option>
                <option value="iso_date">Date ISO stricte (YYYY-MM-DD)</option>
              </optgroup>
              <optgroup label="‚îÄ‚îÄ Codes &amp; r√©f√©rentiels">
                <option value="lang_iso639">Langue ISO 639 (fr, en, de‚Ä¶)</option>
              </optgroup>
              <optgroup label="‚îÄ‚îÄ Avanc√©">
                <option value="custom">Personnalis√© (regex)‚Ä¶</option>
              </optgroup>
            </select>
            <div id="cfg-format-hint" class="format-hint" hidden></div>
            <div id="cfg-custom-regex-wrap" class="custom-regex-wrap" hidden>
              <input type="text" id="cfg-regex" class="input-sm" placeholder="Expression r√©guli√®re (ex : ^\d{5}$)" />
              <span class="format-hint">Laissez vide pour d√©sactiver. Utilisez une expression r√©guli√®re Python.</span>
            </div>
            <!-- Oui / Non ‚Äî champs personnalis√©s (visible uniquement si preset = yes_no) -->
            <div id="cfg-yesno-wrap" class="yesno-wrap" hidden>
              <p class="format-hint yesno-intro">Personnalisez les valeurs accept√©es (s√©par√©es par des virgules).</p>
              <div class="yesno-row">
                <label for="cfg-yesno-true">Valeurs vraies :</label>
                <input type="text" id="cfg-yesno-true" class="input-sm"
                  placeholder="oui, o, vrai, true, yes, y, 1" />
              </div>
              <div class="yesno-row">
                <label for="cfg-yesno-false">Valeurs fausses :</label>
                <input type="text" id="cfg-yesno-false" class="input-sm"
                  placeholder="non, n, faux, false, no, 0" />
              </div>
            </div>
          </div>
          <div class="col-config-field">
            <label>Longueur min / max</label>
            <div class="length-row">
              <input type="number" id="cfg-min-length" class="input-sm input-num" placeholder="Min" min="0" />
              <span class="length-sep">‚Äì</span>
              <input type="number" id="cfg-max-length" class="input-sm input-num" placeholder="Max" min="0" />
            </div>
          </div>
          <div class="col-config-field">
            <label for="cfg-forbidden-chars">Caract√®res interdits</label>
            <input type="text" id="cfg-forbidden-chars" class="input-sm"
              placeholder="Ex : ;|&quot; (chaque caract√®re saisi sera interdit)" />
            <span class="format-hint">Saisissez les caract√®res √† interdire, sans s√©parateur.</span>
          </div>
          <div class="col-config-field">
            <label for="cfg-expected-case">Casse attendue</label>
            <select id="cfg-expected-case" class="input-sm">
              <option value="">Aucune contrainte</option>
              <option value="upper">MAJUSCULES</option>
              <option value="lower">minuscules</option>
              <option value="title">Titre</option>
            </select>
          </div>
          <div class="col-config-field col-config-full">
            <label for="cfg-allowed-values" id="cfg-av-label">Valeurs autoris√©es (une par ligne)</label>
            <div id="cfg-av-locked-msg" class="av-locked-msg" hidden>
              üîí Liste d√©finie par le mod√®le (non modifiable)
            </div>
            <div id="cfg-av-count-msg" class="av-count-msg" hidden></div>
            <textarea id="cfg-allowed-values" rows="3"
              placeholder="Laisser vide pour d√©sactiver cette r√®gle"></textarea>
            <button id="cfg-av-voir-tout" class="btn-link" hidden
              onclick="_toggleAllowedValuesExpand()">Voir tout</button>
            <div class="av-import-row">
              <span class="format-hint">ou</span>
              <button class="btn-link" onclick="triggerImportVocabulary()">Importer un vocabulaire (.yml)</button>
              <input type="file" id="import-vocabulary-input" accept=".yml,.yaml,.txt" hidden />
            </div>
          </div>
          <!-- Vocabulaire distant NAKALA -->
          <div class="col-config-field col-config-full">
            <label for="cfg-nakala-vocabulary">Vocabulaire distant (NAKALA)</label>
            <div class="nakala-vocab-row">
              <select id="cfg-nakala-vocabulary" class="input-sm">
                <option value="">Aucun</option>
                <option value="datatypes">NAKALA ‚Äî Types de ressource (COAR, 29 valeurs)</option>
                <option value="licenses">NAKALA ‚Äî Licences (SPDX, 620 valeurs)</option>
                <option value="languages">NAKALA ‚Äî Langues (ISO 639-3, ~8 000 valeurs)</option>
              </select>
              <button class="btn btn-sm" onclick="loadNakalaVocabulary()">Charger</button>
            </div>
            <div id="nakala-vocab-status" class="format-hint" hidden></div>
          </div>
          <!-- Valeurs rares -->
          <div class="col-config-field col-config-full">
            <label class="checkbox-label">
              <input type="checkbox" id="cfg-detect-rare" />
              Signaler les valeurs rares (suspicions de fautes de saisie)
            </label>
            <div id="cfg-rare-options" class="rare-options" hidden>
              <div class="rare-row">
                <label for="cfg-rare-threshold">Seuil d'occurrences :</label>
                <input type="number" id="cfg-rare-threshold" class="input-sm input-num"
                  min="1" value="1" placeholder="1" />
                <span class="format-hint">valeur ‚â§ seuil ‚Üí signal√©e</span>
              </div>
              <div class="rare-row">
                <label for="cfg-rare-min-total">Minimum de valeurs non vides :</label>
                <input type="number" id="cfg-rare-min-total" class="input-sm input-num"
                  min="1" value="10" placeholder="10" />
              </div>
            </div>
          </div>
          <!-- Valeurs similaires -->
          <div class="col-config-field col-config-full">
            <label class="checkbox-label">
              <input type="checkbox" id="cfg-detect-similar" />
              D√©tecter les valeurs tr√®s proches (variantes orthographiques probables)
            </label>
            <div id="cfg-similar-options" class="similar-options" hidden>
              <div class="similar-row">
                <label for="cfg-similar-threshold">Seuil de similarit√© (%) :</label>
                <input type="number" id="cfg-similar-threshold" class="input-sm input-num"
                  min="50" max="99" value="85" placeholder="85" />
                <span class="format-hint">paire ‚â• seuil ‚Üí signal√©e (85 recommand√©)</span>
              </div>
            </div>
          </div>
          <!-- List section -->
          <div class="col-config-field col-config-full list-section">
            <div class="list-section-header">‚îÄ‚îÄ Liste (valeurs multiples)</div>
            <span class="format-hint">Laissez vide si la colonne ne contient pas de listes.</span>
            <div class="list-section-body">
              <div class="list-sep-row">
                <label for="cfg-list-separator">S√©parateur :</label>
                <input type="text" id="cfg-list-separator" class="input-sm input-sep"
                  maxlength="3" placeholder="ex : |" />
              </div>
              <div id="cfg-list-options" class="list-options">
                <label class="checkbox-label">
                  <input type="checkbox" id="cfg-list-unique" />
                  √âl√©ments uniques dans la liste
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="cfg-list-no-empty" checked />
                  Interdire les √©l√©ments vides
                </label>
                <div class="list-minmax-row">
                  <label>Nombre min :</label>
                  <input type="number" id="cfg-list-min-items" class="input-sm input-num" min="1" placeholder="‚Äî" />
                  <label>max :</label>
                  <input type="number" id="cfg-list-max-items" class="input-sm input-num" min="1" placeholder="‚Äî" />
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Aper√ßu de l'impact sur les donn√©es r√©elles -->
        <div class="rule-preview-section">
          <div class="rule-preview-header">‚îÄ‚îÄ Aper√ßu sur vos donn√©es</div>
          <div id="rule-preview" class="rule-preview-body">
            <span class="rule-preview-empty">Aucune contrainte configur√©e.</span>
          </div>
        </div>

        <div class="col-config-actions">
          <button class="btn btn-primary" onclick="applyColumnConfig()">Appliquer</button>
          <span id="col-config-saved" class="col-config-saved" hidden>‚úì Enregistr√©</span>
        </div>
      </div>

      <!-- R√©sum√© de config (affich√© avant de passer aux correctifs) -->
      <div id="config-summary" class="card mt-2" hidden>
        <h3>R√©sum√© de la configuration</h3>
        <div id="config-summary-content"></div>
        <div class="action-row mt-2">
          <button class="btn btn-secondary" onclick="hideConfigSummary()">‚Üê Modifier</button>
          <button class="btn btn-primary" onclick="configureDone()">Continuer ‚Üí</button>
        </div>
      </div>

      <div class="action-row mt-2" id="configure-action-row">
        <button class="btn btn-secondary" onclick="configureDone()">Passer (sans configuration) ‚Üí</button>
        <button class="btn btn-primary" onclick="showConfigSummary()">√âtape suivante ‚Üí</button>
      </div>
    </section>

    <!-- ================================================================
         √âTAPE 3 : CORRECTIFS
         ================================================================ -->
    <section id="step-fixes" class="step-section" hidden>
      <h2>Correctifs d'hygi√®ne</h2>
      <p class="step-desc">S√©lectionnez les correctifs √† appliquer avant la validation.</p>

      <div class="card">
        <h3>Correctifs disponibles</h3>

        <div class="fix-item">
          <label>
            <input type="checkbox" id="fix-trim" />
            Supprimer les espaces en d√©but et fin
          </label>
          <span class="fix-desc">Supprime les espaces superflus avant et apr√®s chaque valeur.</span>
        </div>
        <div class="fix-item">
          <label>
            <input type="checkbox" id="fix-collapse" />
            R√©duire les espaces multiples
          </label>
          <span class="fix-desc">Remplace toute s√©quence d'espaces par un seul espace.</span>
        </div>
        <div class="fix-item">
          <label>
            <input type="checkbox" id="fix-nbsp" />
            Remplacer les espaces ins√©cables (NBSP)
          </label>
          <span class="fix-desc">Remplace les espaces ins√©cables (U+00A0) par des espaces normaux.</span>
        </div>
        <div class="fix-item">
          <label>
            <input type="checkbox" id="fix-invisible" />
            Supprimer les caract√®res invisibles
          </label>
          <span class="fix-desc">Supprime les caract√®res de largeur nulle (U+200B, U+FEFF, etc.).</span>
        </div>
        <div class="fix-item">
          <label>
            <input type="checkbox" id="fix-unicode" />
            Normaliser l'Unicode
          </label>
          <span class="fix-desc">Remplace les guillemets courbes, tirets fantaisie, etc. par leurs √©quivalents ASCII.</span>
        </div>
        <div class="fix-item">
          <label>
            <input type="checkbox" id="fix-newlines" />
            Normaliser les retours √† la ligne
          </label>
          <span class="fix-desc">Convertit les fins de ligne Windows (\\r\\n) en Unix (\\n).</span>
        </div>

        <div class="form-grid mt-2">
          <label for="fix-columns">Appliquer seulement √† certaines colonnes :</label>
          <select id="fix-columns" class="input-sm">
            <option value="">Toutes les colonnes</option>
          </select>
        </div>
      </div>

      <div class="card mt-2">
        <h3>Aper√ßu des modifications</h3>
        <button class="btn btn-secondary" onclick="previewFixes()">Calculer l'aper√ßu</button>
        <div id="fixes-preview" class="mt-1"></div>
      </div>

      <div class="action-row mt-2">
        <div class="undo-redo-bar">
          <button id="btn-undo" class="btn btn-secondary btn-sm" onclick="undoFix()" disabled title="Annuler le dernier correctif (Ctrl+Z)">‚Ü© Annuler</button>
          <button id="btn-redo" class="btn btn-secondary btn-sm" onclick="redoFix()" disabled title="R√©tablir (Ctrl+Shift+Z)">‚Ü™ R√©tablir</button>
        </div>
        <button class="btn btn-secondary" onclick="skipFixes()">Passer (sans correctifs) ‚Üí</button>
        <button class="btn btn-primary" onclick="applyFixes()">Appliquer les correctifs ‚Üí</button>
      </div>
    </section>

    <!-- ================================================================
         √âTAPE 4 : VALIDATION
         ================================================================ -->
    <section id="step-validate" class="step-section" hidden>
      <h2>Validation</h2>
      <p class="step-desc">Lancement de la validation sur le fichier‚Ä¶</p>

      <div class="progress-container" id="validate-progress">
        <div class="spinner"></div>
        <p>Validation en cours‚Ä¶</p>
      </div>

      <div id="validate-summary" hidden>
        <div class="summary-cards">
          <div class="summary-card summary-error">
            <div class="summary-count" id="sum-errors">0</div>
            <div class="summary-label">Erreur(s)</div>
          </div>
          <div class="summary-card summary-warning">
            <div class="summary-count" id="sum-warnings">0</div>
            <div class="summary-label">Avertissement(s)</div>
          </div>
          <div class="summary-card summary-suspicion">
            <div class="summary-count" id="sum-suspicions">0</div>
            <div class="summary-label">Suspicion(s)</div>
          </div>
          <div class="summary-card summary-total">
            <div class="summary-count" id="sum-total">0</div>
            <div class="summary-label">Total</div>
          </div>
        </div>
        <div class="action-row mt-2">
          <button class="btn btn-primary" onclick="goToStep('results')">Voir les r√©sultats ‚Üí</button>
        </div>
      </div>
    </section>

    <!-- ================================================================
         √âTAPE 5 : R√âSULTATS
         ================================================================ -->
    <section id="step-results" class="step-section" hidden>
      <h2>R√©sultats de la validation</h2>

      <!-- Downloads -->
      <div class="card">
        <h3>T√©l√©charger</h3>
        <div class="download-buttons">
          <a id="dl-report" class="btn btn-download" href="#" onclick="return downloadFile('rapport.txt')">
            üìÑ Rapport de validation (.txt)
          </a>
          <a id="dl-problems" class="btn btn-download" href="#" onclick="return downloadFile('problemes.csv')">
            üìã Liste des probl√®mes (.csv)
          </a>
          <a id="dl-xlsx" class="btn btn-download" href="#" onclick="return downloadFile('nettoye.xlsx')">
            üìä Tableur nettoy√© (.xlsx)
          </a>
          <a id="dl-csv" class="btn btn-download" href="#" onclick="return downloadFile('nettoye.csv')">
            üìë Tableur nettoy√© (.csv)
          </a>
        </div>
      </div>

      <!-- Filters -->
      <div class="card mt-2">
        <h3>Probl√®mes d√©tect√©s</h3>
        <div class="filter-bar">
          <label>S√©v√©rit√© :
            <select id="filter-severity" onchange="loadProblems(1)">
              <option value="">Toutes les s√©v√©rit√©s</option>
              <option value="ERROR">Erreur</option>
              <option value="WARNING">Avertissement</option>
              <option value="SUSPICION">Suspicion</option>
            </select>
          </label>
          <label>Filtrer par colonne :
            <select id="filter-column" onchange="loadProblems(1)">
              <option value="">Toutes les colonnes</option>
            </select>
          </label>
          <label>Statut :
            <select id="filter-status" onchange="loadProblems(1)">
              <option value="">Tous les statuts</option>
              <option value="OPEN">Ouverts</option>
              <option value="IGNORED">Ignor√©s</option>
              <option value="EXCEPTED">Exclus</option>
            </select>
          </label>
        </div>

        <div id="bulk-action-bar" class="bulk-action-bar" hidden>
          <span id="bulk-selected-count" class="bulk-count">0 s√©lectionn√©(s)</span>
          <button class="btn btn-sm btn-secondary" onclick="bulkIgnoreSelected()">Ignorer la s√©lection</button>
          <button class="btn btn-sm btn-secondary" onclick="bulkExceptSelected()">Exclure la s√©lection</button>
          <button class="btn btn-sm btn-secondary" onclick="bulkReopenSelected()">Rouvrir la s√©lection</button>
        </div>

        <div id="problems-container">
          <table class="problems-table" id="problems-table">
            <thead>
              <tr>
                <th class="th-check"><input type="checkbox" id="check-all-problems" onchange="toggleAllProblems(this)" title="Tout s√©lectionner" /></th>
                <th>S√©v√©rit√©</th>
                <th>Colonne</th>
                <th>Ligne</th>
                <th>Message</th>
                <th>Suggestion</th>
                <th class="th-actions">Actions</th>
                <th class="th-nav"></th>
              </tr>
            </thead>
            <tbody id="problems-body"></tbody>
          </table>
          <div class="pagination" id="pagination"></div>
          <div id="no-issues" class="msg-success" hidden>
            ‚úÖ Aucun probl√®me d√©tect√©. Le fichier est valide !
          </div>
        </div>
      </div>

      <div class="action-row mt-2">
        <button class="btn btn-secondary" onclick="resetApp()">Nouveau fichier</button>
      </div>
    </section>

  </main>

  <footer class="app-footer">
    <p>Tablerreur ‚Äî Contr√¥le qualit√© tableurs ¬∑ <a href="https://github.com/anthropics/claude-code" target="_blank">Open source</a></p>
  </footer>

  <script src="/static/app.js"></script>
</body>
</html>
